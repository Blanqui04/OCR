<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR - Reconeixement Òptic de Caràcters</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-file-text"></i> OCR System</h1>
                <p class="subtitle">Reconeixement Òptic de Caràcters Avançat</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Upload Section -->
            <section class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h3>Arrossega els teus fitxers aquí</h3>
                        <p>o fes clic per seleccionar</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.png,.jpg,.jpeg,.tiff,.bmp">
                        <div class="file-types">
                            <span>Formats suportats: PDF, PNG, JPG, JPEG, TIFF, BMP</span>
                        </div>
                    </div>
                </div>
                
                <!-- File List -->
                <div class="file-list" id="fileList" style="display: none;">
                    <h3><i class="fas fa-list"></i> Fitxers seleccionats:</h3>
                    <div id="selectedFiles"></div>
                </div>
            </section>

            <!-- Processing Options -->
            <section class="options-section">
                <h3><i class="fas fa-cogs"></i> Opcions de Processament</h3>
                <div class="options-grid">
                    <div class="option-card">
                        <h4><i class="fas fa-language"></i> Idioma</h4>
                        <select id="languageSelect">
                            <option value="cat">Català</option>
                            <option value="spa">Espanyol</option>
                            <option value="eng" selected>Anglès</option>
                            <option value="fra">Francès</option>
                        </select>
                    </div>
                    
                    <div class="option-card">
                        <h4><i class="fas fa-search"></i> Mode OCR</h4>
                        <select id="ocrMode">
                            <option value="accurate">Precís</option>
                            <option value="fast" selected>Ràpid</option>
                            <option value="enhanced">Millorat</option>
                        </select>
                    </div>
                    
                    <div class="option-card">
                        <h4><i class="fas fa-file-export"></i> Format de sortida</h4>
                        <select id="outputFormat">
                            <option value="txt">Text (.txt)</option>
                            <option value="json" selected>JSON (.json)</option>
                            <option value="csv">CSV (.csv)</option>
                            <option value="xml">XML (.xml)</option>
                        </select>
                    </div>
                    
                    <div class="option-card">
                        <h4><i class="fas fa-table"></i> Detecció de taules</h4>
                        <label class="switch">
                            <input type="checkbox" id="tableDetection" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <section class="actions-section">
                <button class="btn btn-primary" id="processBtn" disabled>
                    <i class="fas fa-play"></i> Iniciar Processament
                </button>
                <button class="btn btn-secondary" id="clearBtn">
                    <i class="fas fa-trash"></i> Netejar
                </button>
                <button class="btn btn-info" id="previewBtn" disabled>
                    <i class="fas fa-eye"></i> Vista prèvia
                </button>
            </section>

            <!-- Progress Section -->
            <section class="progress-section" id="progressSection" style="display: none;">
                <h3><i class="fas fa-tasks"></i> Progrés del processament</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">0%</div>
                </div>
                <div class="progress-status" id="progressStatus">Esperant...</div>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <h3><i class="fas fa-clipboard-list"></i> Resultats</h3>
                <div class="results-container">
                    <div class="results-tabs">
                        <button class="tab-btn active" data-tab="text">
                            <i class="fas fa-font"></i> Text
                        </button>
                        <button class="tab-btn" data-tab="tables">
                            <i class="fas fa-table"></i> Taules
                        </button>
                        <button class="tab-btn" data-tab="metadata">
                            <i class="fas fa-info-circle"></i> Metadades
                        </button>
                    </div>
                    
                    <div class="tab-content">
                        <div id="textTab" class="tab-panel active">
                            <div class="text-output">
                                <div class="output-controls">
                                    <button class="btn btn-small" id="copyTextBtn">
                                        <i class="fas fa-copy"></i> Copiar
                                    </button>
                                    <button class="btn btn-small" id="downloadTextBtn">
                                        <i class="fas fa-download"></i> Descarregar
                                    </button>
                                </div>
                                <pre id="textOutput" class="output-content"></pre>
                            </div>
                        </div>
                        
                        <div id="tablesTab" class="tab-panel">
                            <div id="tablesOutput" class="output-content"></div>
                        </div>
                        
                        <div id="metadataTab" class="tab-panel">
                            <div id="metadataOutput" class="output-content"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 Sistema OCR Avançat. Tots els drets reservats.</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Processant...</p>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // JavaScript functionality will be added here
        $(document).ready(function() {
            // File upload handling
            const uploadArea = $('#uploadArea');
            const fileInput = $('#fileInput');
            const fileList = $('#fileList');
            const selectedFiles = $('#selectedFiles');
            const processBtn = $('#processBtn');
            const previewBtn = $('#previewBtn');
            
            let files = [];

            // Drag and drop functionality
            uploadArea.on('dragover', function(e) {
                e.preventDefault();
                $(this).addClass('dragover');
            });

            uploadArea.on('dragleave', function(e) {
                e.preventDefault();
                $(this).removeClass('dragover');
            });

            uploadArea.on('drop', function(e) {
                e.preventDefault();
                $(this).removeClass('dragover');
                handleFiles(e.originalEvent.dataTransfer.files);
            });

            uploadArea.on('click', function() {
                fileInput.click();
            });

            fileInput.on('change', function() {
                handleFiles(this.files);
            });

            function handleFiles(fileList) {
                files = Array.from(fileList);
                displayFiles();
                processBtn.prop('disabled', files.length === 0);
                previewBtn.prop('disabled', files.length === 0);
            }

            function displayFiles() {
                if (files.length > 0) {
                    $('#fileList').show();
                    let html = '';
                    files.forEach((file, index) => {
                        html += `
                            <div class="file-item">
                                <i class="fas fa-file"></i>
                                <span class="file-name">${file.name}</span>
                                <span class="file-size">${formatFileSize(file.size)}</span>
                                <button class="btn btn-small btn-danger" onclick="removeFile(${index})">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        `;
                    });
                    selectedFiles.html(html);
                } else {
                    $('#fileList').hide();
                }
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            // Tab functionality
            $('.tab-btn').on('click', function() {
                const tab = $(this).data('tab');
                $('.tab-btn').removeClass('active');
                $('.tab-panel').removeClass('active');
                $(this).addClass('active');
                $(`#${tab}Tab`).addClass('active');
            });

            // Process button functionality
            processBtn.on('click', function() {
                if (files.length === 0) return;
                
                // Show progress section
                $('#progressSection').show();
                $('#resultsSection').hide();
                
                // Simulate processing
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        // Show results after completion
                        setTimeout(() => {
                            showResults();
                        }, 500);
                    }
                    
                    $('#progressFill').css('width', progress + '%');
                    $('#progressText').text(Math.round(progress) + '%');
                    
                    if (progress < 30) {
                        $('#progressStatus').text('Processant imatges...');
                    } else if (progress < 70) {
                        $('#progressStatus').text('Executant OCR...');
                    } else if (progress < 95) {
                        $('#progressStatus').text('Extraient taules...');
                    } else {
                        $('#progressStatus').text('Finalitzant...');
                    }
                }, 200);
            });

            function showResults() {
                $('#resultsSection').show();
                
                // Sample results
                $('#textOutput').text(`
Resultats del reconeixement òptic de caràcters:

Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
Ut enim ad minim veniam, quis nostrud exercitation ullamco 
laboris nisi ut aliquip ex ea commodo consequat.

Duis aute irure dolor in reprehenderit in voluptate velit 
esse cillum dolore eu fugiat nulla pariatur. Excepteur sint 
occaecat cupidatat non proident, sunt in culpa qui officia 
deserunt mollit anim id est laborum.
                `);
                
                $('#tablesOutput').html(`
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Element</th>
                                <th>Valor</th>
                                <th>Confiança</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Text principal</td>
                                <td>Detectat</td>
                                <td>95.2%</td>
                            </tr>
                            <tr>
                                <td>Taules</td>
                                <td>2 trobades</td>
                                <td>88.7%</td>
                            </tr>
                            <tr>
                                <td>Imatges</td>
                                <td>3 trobades</td>
                                <td>92.1%</td>
                            </tr>
                        </tbody>
                    </table>
                `);
                
                $('#metadataOutput').html(`
                    <div class="metadata-info">
                        <div class="metadata-item">
                            <strong>Fitxers processats:</strong> ${files.length}
                        </div>
                        <div class="metadata-item">
                            <strong>Temps de processament:</strong> 2.3 segons
                        </div>
                        <div class="metadata-item">
                            <strong>Idioma detectat:</strong> Català/Espanyol
                        </div>
                        <div class="metadata-item">
                            <strong>Confiança mitjana:</strong> 91.7%
                        </div>
                        <div class="metadata-item">
                            <strong>Paraules extretes:</strong> 247
                        </div>
                    </div>
                `);
            }

            // Clear button functionality
            $('#clearBtn').on('click', function() {
                files = [];
                displayFiles();
                processBtn.prop('disabled', true);
                previewBtn.prop('disabled', true);
                $('#progressSection').hide();
                $('#resultsSection').hide();
                $('#progressFill').css('width', '0%');
                $('#progressText').text('0%');
            });

            // Copy text functionality
            $('#copyTextBtn').on('click', function() {
                const text = $('#textOutput').text();
                navigator.clipboard.writeText(text).then(() => {
                    // Show success message
                    $(this).html('<i class="fas fa-check"></i> Copiat!');
                    setTimeout(() => {
                        $(this).html('<i class="fas fa-copy"></i> Copiar');
                    }, 2000);
                });
            });
        });

        function removeFile(index) {
            files.splice(index, 1);
            displayFiles();
            $('#processBtn').prop('disabled', files.length === 0);
            $('#previewBtn').prop('disabled', files.length === 0);
        }
    </script>
</body>
</html>